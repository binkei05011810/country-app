{"ast":null,"code":"// Put effect similar to dispatch in thunk => trigger another action to send data to reducer\nimport { takeEvery, put, select, fork, all } from 'redux-saga/effects';\n// Effects like takeEvery, takeLatest: define when to run the saga (which action type will trigger the saga)\n// Saga have to be triggered. thunk can be called straight away\nimport { getCountrySuccess, GET_COUNTRY_SAGA, reactCountrySuccess, LIKE_COUNTRY_SAGA, UNLIKE_COUNTRY_SAGA, SEARCH_COUNTRY_SAGA, searchCountrySuccess } from '../actions';\n\nconst getSearchInput = store => store.countryReducer.input;\n\nfunction* getCountry() {\n  yield takeEvery(GET_COUNTRY_SAGA, function* (action) {\n    const name = action.payload;\n    const searchInput = yield select(getSearchInput);\n    const url = `https://restcountries.eu/rest/v2/${name ? `name/${name}?fullText=true` : \"all\"}`; //@ts-ignore\n\n    const response = yield fetch(url); //@ts-ignore\n\n    const data = yield response.json();\n    let searchCountries = data;\n\n    if (!name) {\n      searchCountries = data.filter(country => country.name.slice(0, searchInput.length).toLowerCase() === searchInput.toLowerCase());\n    }\n\n    yield put(getCountrySuccess(data));\n  });\n} // Put effect similar to dispatch in thunk => trigger another action to send data to reducer\n\n\nconst getFavCountries = store => store.countryReducer.favCountries; // Effects like takeEvery, takeLatest: define when to run the saga (which action type will trigger the saga)\n// Saga have to be triggered. thunk can be called straight away\n\n\nfunction* likeSaga() {\n  yield takeEvery(LIKE_COUNTRY_SAGA, function* (action) {\n    //@ts-ignore\n    const favCountries = yield select(getFavCountries);\n    const country = action.payload;\n    const newFav = [...favCountries, country];\n    localStorage.setItem(\"favCountries\", JSON.stringify(newFav)); //@ts-ignore\n\n    yield put(reactCountrySuccess(newFav));\n  });\n}\n\nfunction* unlikeSaga() {\n  yield takeEvery(UNLIKE_COUNTRY_SAGA, function* (action) {\n    //@ts-ignore\n    const favCountries = yield select(getFavCountries);\n    const countryName = action.payload;\n    const remainingFav = favCountries.filter(country => country.name !== countryName);\n    localStorage.setItem(\"favCountries\", JSON.stringify(remainingFav)); //@ts-ignore\n\n    yield put(reactCountrySuccess(remainingFav));\n  });\n}\n\nconst getAllCountries = store => store.countryReducer.allCountries;\n\nfunction* searchSaga() {\n  yield takeEvery(SEARCH_COUNTRY_SAGA, function* (action) {\n    //@ts-ignore\n    const allCountries = yield select(getAllCountries);\n    const input = action.payload;\n    const searchResults = allCountries.filter(country => country.name.slice(0, input.length).toLowerCase() === input.toLowerCase());\n    localStorage.setItem(\"searchInput\", input); //@ts-ignore\n\n    yield put(searchCountrySuccess(input, searchResults));\n  });\n}\n\nfunction* rootSaga() {\n  //@ts-ignore\n  yield all([fork(getCountry), fork(likeSaga), fork(unlikeSaga), fork(searchSaga)]);\n}\n\nexport default rootSaga;","map":{"version":3,"sources":["/Users/meocuabinh/Documents/Integrify/fs7-finland-react-redux-typescript/src/redux/saga/sagas.ts"],"names":["takeEvery","put","select","fork","all","getCountrySuccess","GET_COUNTRY_SAGA","reactCountrySuccess","LIKE_COUNTRY_SAGA","UNLIKE_COUNTRY_SAGA","SEARCH_COUNTRY_SAGA","searchCountrySuccess","getSearchInput","store","countryReducer","input","getCountry","action","name","payload","searchInput","url","response","fetch","data","json","searchCountries","filter","country","slice","length","toLowerCase","getFavCountries","favCountries","likeSaga","newFav","localStorage","setItem","JSON","stringify","unlikeSaga","countryName","remainingFav","getAllCountries","allCountries","searchSaga","searchResults","rootSaga"],"mappings":"AAAA;AACA,SAASA,SAAT,EAAoBC,GAApB,EAAyBC,MAAzB,EAAiCC,IAAjC,EAAuCC,GAAvC,QAAkD,oBAAlD;AAEA;AACA;AAEA,SACIC,iBADJ,EAEIC,gBAFJ,EAIIC,mBAJJ,EAKIC,iBALJ,EAMIC,mBANJ,EASIC,mBATJ,EAWIC,oBAXJ,QAYO,YAZP;;AAgBA,MAAMC,cAAc,GAAIC,KAAD,IAAkBA,KAAK,CAACC,cAAN,CAAqBC,KAA9D;;AAEA,UAAUC,UAAV,GAAqC;AACjC,QAAMhB,SAAS,CAACM,gBAAD,EAAmB,WAAWW,MAAX,EAAsD;AACpF,UAAMC,IAAI,GAAGD,MAAM,CAACE,OAApB;AACA,UAAMC,WAAmB,GAAG,MAAMlB,MAAM,CAACU,cAAD,CAAxC;AACA,UAAMS,GAAG,GAAI,oCAAmCH,IAAI,GAAI,QAAOA,IAAK,gBAAhB,GAAkC,KAAM,EAA5F,CAHoF,CAKpF;;AACA,UAAMI,QAAQ,GAAG,MAAMC,KAAK,CAACF,GAAD,CAA5B,CANoF,CAOpF;;AACA,UAAMG,IAAe,GAAG,MAAMF,QAAQ,CAACG,IAAT,EAA9B;AACA,QAAIC,eAAe,GAAGF,IAAtB;;AAEA,QAAI,CAACN,IAAL,EAAW;AACPQ,MAAAA,eAAe,GAAGF,IAAI,CAACG,MAAL,CAAaC,OAAD,IAAsBA,OAAO,CAACV,IAAR,CAAaW,KAAb,CAAmB,CAAnB,EAAsBT,WAAW,CAACU,MAAlC,EAA0CC,WAA1C,OAA4DX,WAAW,CAACW,WAAZ,EAA9F,CAAlB;AACH;;AAED,UAAM9B,GAAG,CAACI,iBAAiB,CAACmB,IAAD,CAAlB,CAAT;AACH,GAhBc,CAAf;AAiBH,C,CAED;;;AAEA,MAAMQ,eAAe,GAAInB,KAAD,IAAkBA,KAAK,CAACC,cAAN,CAAqBmB,YAA/D,C,CACA;AACA;;;AAEA,UAAUC,QAAV,GAAmC;AAC/B,QAAMlC,SAAS,CAACQ,iBAAD,EAAoB,WAAWS,MAAX,EAAuD;AACtF;AACA,UAAMgB,YAAuB,GAAG,MAAM/B,MAAM,CAAC8B,eAAD,CAA5C;AACA,UAAMJ,OAAO,GAAGX,MAAM,CAACE,OAAvB;AAEA,UAAMgB,MAAM,GAAG,CAAC,GAAGF,YAAJ,EAAkBL,OAAlB,CAAf;AACAQ,IAAAA,YAAY,CAACC,OAAb,CAAqB,cAArB,EAAqCC,IAAI,CAACC,SAAL,CAAeJ,MAAf,CAArC,EANsF,CAQtF;;AACA,UAAMlC,GAAG,CAACM,mBAAmB,CAAC4B,MAAD,CAApB,CAAT;AACH,GAVc,CAAf;AAWH;;AAED,UAAUK,UAAV,GAAqC;AACjC,QAAMxC,SAAS,CAACS,mBAAD,EAAsB,WAAWQ,MAAX,EAAyD;AAC1F;AACA,UAAMgB,YAAuB,GAAG,MAAM/B,MAAM,CAAC8B,eAAD,CAA5C;AACA,UAAMS,WAAW,GAAGxB,MAAM,CAACE,OAA3B;AAEA,UAAMuB,YAAY,GAAGT,YAAY,CAACN,MAAb,CAAqBC,OAAD,IAAsBA,OAAO,CAACV,IAAR,KAAiBuB,WAA3D,CAArB;AACAL,IAAAA,YAAY,CAACC,OAAb,CAAqB,cAArB,EAAqCC,IAAI,CAACC,SAAL,CAAeG,YAAf,CAArC,EAN0F,CAQ1F;;AACA,UAAMzC,GAAG,CAACM,mBAAmB,CAACmC,YAAD,CAApB,CAAT;AACH,GAVc,CAAf;AAWH;;AAED,MAAMC,eAAe,GAAI9B,KAAD,IAAkBA,KAAK,CAACC,cAAN,CAAqB8B,YAA/D;;AAEA,UAAUC,UAAV,GAAqC;AACjC,QAAM7C,SAAS,CAACU,mBAAD,EAAsB,WAAWO,MAAX,EAAyD;AAC1F;AACA,UAAM2B,YAAuB,GAAG,MAAM1C,MAAM,CAACyC,eAAD,CAA5C;AACA,UAAM5B,KAAK,GAAGE,MAAM,CAACE,OAArB;AACA,UAAM2B,aAAa,GAAGF,YAAY,CAACjB,MAAb,CAAqBC,OAAD,IAAsBA,OAAO,CAACV,IAAR,CAAaW,KAAb,CAAmB,CAAnB,EAAsBd,KAAK,CAACe,MAA5B,EAAoCC,WAApC,OAAsDhB,KAAK,CAACgB,WAAN,EAAhG,CAAtB;AACAK,IAAAA,YAAY,CAACC,OAAb,CAAqB,aAArB,EAAoCtB,KAApC,EAL0F,CAO1F;;AACA,UAAMd,GAAG,CAACU,oBAAoB,CAACI,KAAD,EAAQ+B,aAAR,CAArB,CAAT;AACH,GATc,CAAf;AAUH;;AAED,UAAUC,QAAV,GAAqB;AACjB;AACA,QAAM3C,GAAG,CAAC,CAACD,IAAI,CAACa,UAAD,CAAL,EAAmBb,IAAI,CAAC+B,QAAD,CAAvB,EAAmC/B,IAAI,CAACqC,UAAD,CAAvC,EAAqDrC,IAAI,CAAC0C,UAAD,CAAzD,CAAD,CAAT;AACH;;AAED,eAAeE,QAAf","sourcesContent":["// Put effect similar to dispatch in thunk => trigger another action to send data to reducer\nimport { takeEvery, put, select, fork, all } from 'redux-saga/effects';\nimport { SagaIterator } from '@redux-saga/core';\n// Effects like takeEvery, takeLatest: define when to run the saga (which action type will trigger the saga)\n// Saga have to be triggered. thunk can be called straight away\n\nimport {\n    getCountrySuccess,\n    GET_COUNTRY_SAGA,\n    getCountrySaga,\n    reactCountrySuccess,\n    LIKE_COUNTRY_SAGA,\n    UNLIKE_COUNTRY_SAGA,\n    likeCountrySaga,\n    unlikeCountrySaga,\n    SEARCH_COUNTRY_SAGA,\n    searchCountrySaga,\n    searchCountrySuccess\n} from '../actions';\nimport { Store } from '../store';\nimport { Country } from '../../types/types';\n\nconst getSearchInput = (store: Store) => store.countryReducer.input;\n\nfunction* getCountry(): SagaIterator {\n    yield takeEvery(GET_COUNTRY_SAGA, function* (action: ReturnType<typeof getCountrySaga>) {\n        const name = action.payload;\n        const searchInput: string = yield select(getSearchInput);\n        const url = `https://restcountries.eu/rest/v2/${name ? `name/${name}?fullText=true` : \"all\"}`;\n\n        //@ts-ignore\n        const response = yield fetch(url);\n        //@ts-ignore\n        const data: Country[] = yield response.json();\n        let searchCountries = data;\n\n        if (!name) {\n            searchCountries = data.filter((country: Country) => country.name.slice(0, searchInput.length).toLowerCase() === searchInput.toLowerCase());\n        }\n\n        yield put(getCountrySuccess(data));\n    })\n}\n\n// Put effect similar to dispatch in thunk => trigger another action to send data to reducer\n\nconst getFavCountries = (store: Store) => store.countryReducer.favCountries;\n// Effects like takeEvery, takeLatest: define when to run the saga (which action type will trigger the saga)\n// Saga have to be triggered. thunk can be called straight away\n\nfunction* likeSaga(): SagaIterator {\n    yield takeEvery(LIKE_COUNTRY_SAGA, function* (action: ReturnType<typeof likeCountrySaga>) {\n        //@ts-ignore\n        const favCountries: Country[] = yield select(getFavCountries);\n        const country = action.payload;\n\n        const newFav = [...favCountries, country];\n        localStorage.setItem(\"favCountries\", JSON.stringify(newFav));\n\n        //@ts-ignore\n        yield put(reactCountrySuccess(newFav));\n    })\n}\n\nfunction* unlikeSaga(): SagaIterator {\n    yield takeEvery(UNLIKE_COUNTRY_SAGA, function* (action: ReturnType<typeof unlikeCountrySaga>) {\n        //@ts-ignore\n        const favCountries: Country[] = yield select(getFavCountries);\n        const countryName = action.payload;\n\n        const remainingFav = favCountries.filter((country: Country) => country.name !== countryName);\n        localStorage.setItem(\"favCountries\", JSON.stringify(remainingFav));\n\n        //@ts-ignore\n        yield put(reactCountrySuccess(remainingFav));\n    })\n}\n\nconst getAllCountries = (store: Store) => store.countryReducer.allCountries;\n\nfunction* searchSaga(): SagaIterator {\n    yield takeEvery(SEARCH_COUNTRY_SAGA, function* (action: ReturnType<typeof searchCountrySaga>) {\n        //@ts-ignore\n        const allCountries: Country[] = yield select(getAllCountries);\n        const input = action.payload;\n        const searchResults = allCountries.filter((country: Country) => country.name.slice(0, input.length).toLowerCase() === input.toLowerCase());\n        localStorage.setItem(\"searchInput\", input);\n\n        //@ts-ignore\n        yield put(searchCountrySuccess(input, searchResults));\n    })\n}\n\nfunction* rootSaga() {\n    //@ts-ignore\n    yield all([fork(getCountry), fork(likeSaga), fork(unlikeSaga), fork(searchSaga)])\n}\n\nexport default rootSaga;\n"]},"metadata":{},"sourceType":"module"}